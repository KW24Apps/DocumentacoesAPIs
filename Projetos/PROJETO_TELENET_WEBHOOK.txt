# PROJETO TELENET - INTEGRAÃ‡ÃƒO WEBHOOK

## ğŸ“‹ RESUMO EXECUTIVO

Sistema de integraÃ§Ã£o via webhook para recebimento de dados da Telenet e envio automÃ¡tico para Bitrix24. 
A Telenet enviarÃ¡ dados de solicitaÃ§Ãµes via POST HTTP, receberÃ¡ confirmaÃ§Ã£o imediata e os dados serÃ£o processados automaticamente no CRM.

---

## ğŸ“¢ PARA A EQUIPE TELENET

**Prezada equipe tÃ©cnica da Telenet,**

Este documento contÃ©m as **especificaÃ§Ãµes tÃ©cnicas completas** para a integraÃ§Ã£o entre nossos sistemas via webhook HTTP.

### **ğŸ¯ O QUE PRECISAMOS DA TELENET:**

1. **Implementar envio de dados via HTTP POST** para o endpoint que disponibilizaremos
2. **Enviar dados no formato JSON** conforme estrutura detalhada neste documento
3. **Tratar as respostas** de sucesso/erro que retornaremos
4. **Realizar testes** de integraÃ§Ã£o em ambiente de homologaÃ§Ã£o

### **ğŸ”§ O QUE DISPONIBILIZAREMOS:**

- âœ… **Endpoint webhook** configurado e funcional
- âœ… **DocumentaÃ§Ã£o tÃ©cnica completa** (este documento)
- âœ… **Ambiente de testes** para validaÃ§Ã£o
- âœ… **Suporte tÃ©cnico** durante a implementaÃ§Ã£o
- âœ… **Logs detalhados** para troubleshooting

### **ğŸ“‹ PRÃ“XIMOS PASSOS:**

1. **Telenet:** Revisar especificaÃ§Ãµes tÃ©cnicas deste documento
2. **Telenet:** Confirmar viabilidade de implementaÃ§Ã£o
3. **KW24:** Desenvolver e configurar o endpoint webhook
4. **Ambos:** Realizar testes de integraÃ§Ã£o
5. **Ambos:** Deploy em produÃ§Ã£o

**DÃºvidas tÃ©cnicas?** Entre em contato conosco para esclarecimentos.

---

## ğŸ”„ FLUXO DE FUNCIONAMENTO

### **PASSO 1: Telenet envia dados**
```
Telenet Sistema â†’ POST HTTP â†’ triocard.kw24.com.br/telenet
```

### **PASSO 2: Processamento automÃ¡tico**
```
1. Recebimento dos dados
2. ValidaÃ§Ã£o da estrutura JSON
3. Resposta imediata para Telenet (sucesso/erro)
4. Processamento e envio para Bitrix24
5. Log de toda operaÃ§Ã£o
```

### **PASSO 3: IntegraÃ§Ã£o Bitrix24**
```
Dados tratados â†’ Bitrix24 CRM â†’ AtualizaÃ§Ã£o automÃ¡tica
```

---

## ğŸ“¡ ESPECIFICAÃ‡Ã•ES TÃ‰CNICAS

### **ENDPOINT DE RECEBIMENTO:**
- **URL:** `https://triocard.kw24.com.br/telenet`
- **MÃ©todo:** POST
- **Content-Type:** application/json
- **Timeout:** 30 segundos mÃ¡ximo

### **ESTRUTURA JSON ESPERADA:**
```json
{
    "nome_arquivo": "documento_001.pdf",
    "protocolo": "TEL2025080001",
    "data_solicitacao": "2025-08-06 14:30:00",
    "data_retorno_solicitacao": "2025-08-06 16:45:00",
    "mensagem": "SolicitaÃ§Ã£o processada com sucesso",
    "cliente": "Empresa XYZ Ltda",
    "cnpj": "12.345.678/0001-90"
}
```

### **RESPOSTA PADRÃƒO:**
**Sucesso:**
```json
{
    "success": true,
    "message": "Dados recebidos e processados com sucesso",
    "protocolo": "TEL2025080001",
    "timestamp": "2025-08-06 16:45:15"
}
```

**Erro:**
```json
{
    "success": false,
    "error": "DescriÃ§Ã£o do erro",
    "timestamp": "2025-08-06 16:45:15"
}
```

---

## ğŸ›¡ï¸ VALIDAÃ‡Ã•ES E SEGURANÃ‡A

### **ValidaÃ§Ãµes obrigatÃ³rias:**
- âœ… Protocolo nÃ£o pode estar vazio
- âœ… CNPJ deve ter formato vÃ¡lido
- âœ… Datas devem estar no formato Y-m-d H:i:s
- âœ… Cliente nÃ£o pode estar vazio
- âœ… JSON deve ser vÃ¡lido

### **SeguranÃ§a:**
- ğŸ”’ Logs completos de todas as operaÃ§Ãµes
- ğŸ”’ ValidaÃ§Ã£o de origem (IP whitelist se necessÃ¡rio)
- ğŸ”’ Rate limiting (mÃ¡ximo 100 requests/minuto)
- ğŸ”’ SanitizaÃ§Ã£o de dados de entrada

---

## ğŸ“Š TRATAMENTO DE DADOS PARA BITRIX24

### **Mapeamento de campos:**
| Campo Telenet | Campo Bitrix24 | Tipo |
|---------------|----------------|------|
| protocolo | uf_protocolo_telenet | string |
| nome_arquivo | uf_arquivo_telenet | string |
| data_solicitacao | uf_data_solicitacao | datetime |
| data_retorno_solicitacao | uf_data_retorno | datetime |
| mensagem | uf_mensagem_telenet | text |
| cliente | title ou companyId | string |
| cnpj | uf_cnpj_cliente | string |

### **AÃ§Ãµes automÃ¡ticas no Bitrix24:**
1. **Buscar deal existente** pelo protocolo
2. **Criar novo deal** se nÃ£o existir
3. **Atualizar campos** conforme mapeamento
4. **Adicionar comentÃ¡rio** com detalhes da operaÃ§Ã£o
5. **Atualizar estÃ¡gio** do deal (se configurado)

---

## ğŸ“‹ CENÃRIOS DE USO

### **CenÃ¡rio 1: Primeira solicitaÃ§Ã£o**
```
Telenet â†’ Webhook â†’ Criar novo deal no Bitrix24 â†’ Resposta de sucesso
```

### **CenÃ¡rio 2: AtualizaÃ§Ã£o de solicitaÃ§Ã£o existente**
```
Telenet â†’ Webhook â†’ Atualizar deal existente â†’ Resposta de sucesso
```

### **CenÃ¡rio 3: Erro de dados**
```
Telenet â†’ Webhook â†’ ValidaÃ§Ã£o falha â†’ Resposta de erro com detalhes
```

---

## ğŸ”§ IMPLEMENTAÃ‡ÃƒO LADO TELENET

### **Requisitos tÃ©cnicos:**
- **Linguagem:** Qualquer (PHP, Python, C#, Java, etc.)
- **Biblioteca HTTP:** cURL, HttpClient, requests, etc.
- **Formato:** JSON obrigatÃ³rio
- **Headers obrigatÃ³rios:**
  ```
  Content-Type: application/json
  User-Agent: Telenet-System/1.0
  ```

### **Exemplo de implementaÃ§Ã£o (PHP):**
```php
$dados = [
    'nome_arquivo' => 'documento_001.pdf',
    'protocolo' => 'TEL2025080001',
    'data_solicitacao' => '2025-08-06 14:30:00',
    'data_retorno_solicitacao' => '2025-08-06 16:45:00',
    'mensagem' => 'SolicitaÃ§Ã£o processada com sucesso',
    'cliente' => 'Empresa XYZ Ltda',
    'cnpj' => '12.345.678/0001-90'
];

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'https://triocard.kw24.com.br/telenet');
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($dados));
curl_setopt($ch, CURLOPT_HTTPHEADER, [
    'Content-Type: application/json',
    'User-Agent: Telenet-System/1.0'
]);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_TIMEOUT, 30);

$response = curl_exec($ch);
$httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
curl_close($ch);

// Verificar resposta
if ($httpCode === 200) {
    $result = json_decode($response, true);
    if ($result['success']) {
        echo "Dados enviados com sucesso!";
    } else {
        echo "Erro: " . $result['error'];
    }
} else {
    echo "Erro de conexÃ£o. HTTP Code: " . $httpCode;
}
```

---

## ğŸ“ˆ MONITORAMENTO E LOGS

### **Logs automÃ¡ticos:**
- ğŸ“ Todas as requisiÃ§Ãµes recebidas
- ğŸ“ Dados processados e enviados ao Bitrix24
- ğŸ“ Erros e exceÃ§Ãµes detalhadas
- ğŸ“ Performance e tempo de resposta

### **Dashboard de monitoramento:**
- ğŸ“Š Total de requisiÃ§Ãµes por dia
- ğŸ“Š Taxa de sucesso/erro
- ğŸ“Š Tempo mÃ©dio de processamento
- ğŸ“Š Ãšltimas operaÃ§Ãµes realizadas

---

## ğŸš€ BENEFÃCIOS DA INTEGRAÃ‡ÃƒO

### **Para a Telenet:**
- âœ… Resposta imediata de confirmaÃ§Ã£o
- âœ… Interface simples via HTTP POST
- âœ… Logs completos de operaÃ§Ãµes
- âœ… Tratamento automÃ¡tico de erros

### **Para o KW24:**
- âœ… IntegraÃ§Ã£o automÃ¡tica com Bitrix24
- âœ… Dados estruturados e organizados
- âœ… HistÃ³rico completo de operaÃ§Ãµes
- âœ… ReduÃ§Ã£o de trabalho manual

---

## ğŸ“ CONTATOS E SUPORTE

**Equipe tÃ©cnica KW24:**
- Endpoint de teste: `https://triocard.kw24.com.br/telenet/test`
- DocumentaÃ§Ã£o: Este documento
- Suporte: Equipe de desenvolvimento KW24

**PrÃ³ximos passos:**
1. AprovaÃ§Ã£o desta especificaÃ§Ã£o
2. Desenvolvimento do endpoint (KW24)
3. Testes de integraÃ§Ã£o
4. ImplementaÃ§Ã£o no ambiente de produÃ§Ã£o

---

**Documento criado em:** 06/08/2025  
**VersÃ£o:** 1.0  
**Status:** Aguardando aprovaÃ§Ã£o
